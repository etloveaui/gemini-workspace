# 원천적 단점 극복을 위한 실행 가능한 방향 (AI 관점)

작성일: 2025-08-20  
참고: `agent_eval_20250819.md`, `AI_eval_20250819.md`, 루트 `AGENTS.md`, `AGENT_ROLES_GUIDE.md`, `SYSTEM_STATUS.md`, `FUTURE_IMPROVEMENTS.md`

## Executive Summary
- 핵심 병목은 “권한/훅/경로 복잡도”와 “모노레포-다중레포 혼재 UX”다. 기능은 충분하나 운영마찰이 생산성을 갉아먹는다.
- 비전이 아닌 “즉시 적용 가능한 표준화+자동진단+우회 UX”로 마찰을 줄이는 것이 최우선.
- 4개 축으로 접근: ① 정책 표준화, ② Preflight Doctor 강화, ③ Windows-우선 실행 래퍼, ④ 저장소/아카이브 슬림화. 여기에 역할 라우팅 룰을 최소 규칙 엔진으로 도입.

---

## 원인(근본) 요약 → 방향성
1) 워크플로/권한/훅/경로의 복합 규칙 충돌  
→ “표준 템플릿+사전 진단+안전한 우회”의 3단계 UX로 단순화.

2) Windows 경로·인용·UTF-8 차이  
→ PowerShell 기반 공용 래퍼로 명령 표면적을 통일하고, 인용/인코딩 강제.

3) 모노레포 루트 vs `projects/` 독립 Git 혼동  
→ “어디서 git을 해야 하는지”를 파일/도구/메시지 레벨에서 중복 안내.

4) 아카이브/대용량 커밋으로 인한 리포 비대화  
→ LFS/ZIP/주기적 슬림화로 저장/전송 비용 절감.

5) 역할 배정 혼선  
→ ML이 아닌 규칙기반 라우팅부터(현실적·설명가능), 추후 ML로 확장.

---

## 방향성 1: 정책 표준화(작은 규칙으로 큰 안정성)
- 워크플로 표준:
  - 모든 리포 루트 `.github/workflows/` 고정 배치 + `workflow_dispatch` 기본 포함.
  - `paths`는 실제 변경 경로 기준 최소화(글롭 과사용 금지), 기본 브랜치 명시.
  - 권한: PAT(repo+workflow) 또는 적정 fine-grained 토큰 가이드 문서화.
- 커밋 훅 가드 UX:
  - 차단 사유/대상파일/우회 절차를 한 줄로 안내: `--no-verify`는 승인 템플릿 경유.
  - 예외 등록은 PR 템플릿에 “보호 해제 사유/범위/기간” 필수.
- Git Topology 가드:
  - 루트에서 `projects/` 추가 시도를 감지해 메시지로 중단(guide 링크).  
  - 각 `projects/<name>` 루트에 `THIS_IS_GIT_ROOT.md`(간단 예시 포함).

실행 난이도: 낮음  | 효과: 높음  | 리스크: 낮음

---

## 방향성 2: Preflight Doctor 고도화(실패를 사전에 잡기)
- 스코프: 권한·훅·경로·브랜치·remote·PAT·워크플로 경로·Windows 인용 규칙.
- 동작: `venv/Scripts/python -m scripts.doctor_ext` 형태로 실행, [PASS]/[WARN]/[FAIL]과 조치 예시 출력.
- 자동수정(선택): 안전한 항목만(예: 누락된 디렉토리 생성, 기본 브랜치 감지).
- 로그: `usage.db` 또는 `logs/doctor/`에 일시/결과 저장.

실행 난이도: 중간(기존 `scripts/doctor.py` 확장)  | 효과: 매우 높음  | 리스크: 낮음

---

## 방향성 3: Windows-우선 실행 래퍼(표면적 통일)
- PowerShell 래퍼 기본화: 모든 핵심 명령을 ps1로 제공하고 내부에서 인용/UTF-8 강제.
- 예시: `scripts/codex_quick_setup.ps1`(추가됨) 패턴을 표준으로 확장.  
  - 공백/한글/특수문자 파일 경로 안전 처리.
  - 네트워크 제한 시 graceful degrade(설치 단계 건너뛰고 메시지 안내).

실행 난이도: 낮음  | 효과: 높음  | 리스크: 낮음

---

## 방향성 4: 저장/전송 비용 절감(슬림화 by 설계)
- 아카이브 정책 개선:
  - 대형/히스토리 불필요 파일은 ZIP으로 이동 후 Git에는 메타만 커밋.
  - 가능한 경우 Git LFS 도입(미디어/바이너리).
  - 주기적 슬림화 워크플로(태그 기준 컷오프, 압축/정리 리포트).

실행 난이도: 중간  | 효과: 중간~높음  | 리스크: 낮음(정책 합의 필요)

---

## 방향성 5: 규칙기반 역할 라우팅(설명가능, 즉시 도입)
- 간단 매핑 규칙:
  - P0/보안/설계/다중파일 → Claude(설계) → Codex(정밀 구현)
  - 대량·반복·ETL/초기 프로토타입 → Gemini(초안) → Codex(정리) → Claude(승인)
  - 디버깅/성능/테스트 → Codex 우선, 필요 시 Claude 리뷰
- 구현: `.agents/multi_agent_manager.py`에 룰셋 테이블 추가(환경설정으로 조정) → 라우팅 로그 남김.

실행 난이도: 낮음  | 효과: 중간  | 리스크: 낮음

---

## 2주 로드맵(현실적인 순서)
- Week 1
  1) 워크플로 표준 템플릿 배포(`workflow_dispatch`/권한/paths 최소화)
  2) `scripts/doctor.py` 확장 초판(경로/훅/권한/브랜치 기본 점검)
  3) `projects/` 가드 메시지/배너 파일 도입(`THIS_IS_GIT_ROOT.md`)
  4) PowerShell 래퍼 3종: `run_tests.ps1`, `push_safe.ps1`, `preflight.ps1`

- Week 2
  5) Doctor 자동수정(안전 항목) + 로그 저장
  6) 아카이브 ZIP/LFS 정책 초판 + 슬림화 워크플로 시범
  7) 규칙기반 라우팅 테이블 도입 + 운영 로그/리포트 템플릿

---

## 성공 지표(KPI)
- 빌드/워크플로 미실행 이슈: 주당 N→0건  
- 훅 차단 후 미해결 상태 지속: 평균 1일→0.2일 이하  
- Windows 경로/인용 관련 오류: 월간 0건 목표  
- 리포 사이즈 증가율: 월간 +X%→X/2% 이하  
- 작업 라우팅 재배정율: 20%→5% 이하(룰 정확도 향상)

---

## 바로 적용 가능한 산출물(현재 리포 기준)
- `scripts/codex_quick_setup.ps1` 추가됨: 빠른 환경 확인/선택적 설치/가이드 출력.
- `scripts/doctor.py` 존재: 확장 대상(Preflight Doctor v2).
- 권장 신규 파일/작업:
  - `communication/templates/THIS_IS_GIT_ROOT.md` 템플릿 → 각 `projects/<name>`에 배치.
  - `scripts/preflight.ps1` → `doctor.py` 호출+핵심 체크 집약.
  - `.github/workflows/_standard.yml` 샘플 → 각 리포에 복제/경로만 수정.
  - `docs/setup/windows_shell_rules.md` → 인용/경로/UTF-8 규칙 정리.

---

## 리스크와 완화
- 조직/사용자 습관과 충돌: 우회 절차(승인 기반)를 제공해 차단→협력 UX로 전환.
- LFS 도입 마찰: ZIP 우선, LFS는 이미지/모델 등 명백한 대상부터 단계적 적용.
- 규칙기반 라우팅 한계: 로그로 정답 데이터 축적 → P2 이후 ML로 확장.

---

## 결론
비전 확대보다 운영마찰 최소화가 수익구간을 연다. 정책 표준화·Preflight 자동진단·Windows 실행 표준·슬림화·규칙 라우팅의 5축은 현실적으로 즉시 도입 가능하며, 기존 문서/스크립트와 충돌 없이 자연스럽게 녹아든다. 이 2주 패키지를 완료하면, 현재 드러난 “원천적 단점(복잡성→작업 차단)”을 체감 가능한 수준으로 제거하고, 이후 ML 라우팅/고급 자동화를 위한 안전한 발판을 마련할 수 있다.

