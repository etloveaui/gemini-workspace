# ARS Interface V1.00 → V1.01 완전 상세 업데이트 가이드

**작성일:** 2025-08-20  
**작성자:** Claude (Multi-Agent Workspace v2.0)  
**목적:** 엑셀 명세서 V1.01 작성을 위한 완전 상세 가이드  
**기준:** 실제 코드 완전 비교 분석 (01_compare_old vs 00_compare_current)  

---

## 📋 목차
1. [전체 변경 요약](#전체-변경-요약)
2. [모듈별 상세 변경점](#모듈별-상세-변경점)
3. [엑셀 시트별 반영 가이드](#엑셀-시트별-반영-가이드)
4. [API 매핑 테이블](#api-매핑-테이블)
5. [검증 체크리스트](#검증-체크리스트)

---

## 🎯 전체 변경 요약

### 📊 파일 변경 통계
| 파일 유형 | V1.00 | V1.01 | 변경 |
|----------|--------|--------|------|
| 헤더 파일 | 17개 | 17개 | 0 (내용 변경) |
| 구현 파일 | 10개 | 10개 | 0 (내용 변경) |
| **총 API 개수** | **42개** | **51개** | **+9개** |

### 📈 코드 라인 변화
| 모듈 | V1.00 라인 | V1.01 라인 | 증감 | 변화율 |
|------|------------|------------|------|--------|
| BswAdc.c | 74 | 109 | +35 | +47% |
| BswCan.c | 143 | 211 | +68 | +48% |
| BswDio.c | 121 | 226 | +105 | +87% |
| BswSys.c | 40 | 66 | +26 | +65% |
| BswPwm.c | 166 | 178 | +12 | +7% |
| BswSent.c | 115 | 86 | -29 | -25% |

---

## 🔧 모듈별 상세 변경점

### 1. ADC 모듈 (BswAdc.h/c)

#### 🔄 채널 정의 변경
```diff
// V1.00 → V1.01 채널 매크로 변경
- #define BSWADC_CH_SENS_CURR_U		(0U)
- #define BSWADC_CH_SENS_CURR_V		(1U)  
- #define BSWADC_CH_SENS_CURR_W		(2U)
- #define BSWADC_CH_VUC_3V3			(8U)

+ #define BSWADC_CH_SENS_CURR_U_RAW	(0U)
+ #define BSWADC_CH_SENS_CURR_W_RAW	(1U)
+ #define BSWADC_CH_SENS_CURR_DC_RAW	(2U)
+ #define BSWADC_CH_VUC_5V0			(8U)
```

#### ➕ 신규 상수 정의
```c
// 전류 캘리브레이션 상태
#define BSWADC_CALIB_IN_PROGRESS    (0U)
#define BSWADC_CALIB_PASS           (1U)
#define BSWADC_CALIB_FAIL           (2U)

// 모터 온도 센서 에러 상태
#define BSWADC_MOTOR_TEMP_VALID     (0U)
#define BSWADC_MOTOR_TEMP_INVALID   (1U)
```

#### ➕ 신규 API 함수
```c
extern uint8 ShrHWIA_BswAdc_GetCurrentCalibStatus(void);
extern uint8 ShrHWIA_BswAdc_GetMotorTempErrStatus(void);
```

#### 📝 엑셀 반영 내용
**01_IF_BSW→ASW 시트:**
- 기존 ADC 채널 행들을 수정:
  - SENS_CURR_U → SENS_CURR_U_RAW (채널 0)
  - SENS_CURR_V 삭제, SENS_CURR_W → SENS_CURR_W_RAW (채널 1)  
  - 신규: SENS_CURR_DC_RAW (채널 2)
  - VUC_3V3 → VUC_5V0 (채널 8)
- 신규 API 2개 추가:
  1. GetCurrentCalibStatus: 반환값 0(진행중)/1(성공)/2(실패)
  2. GetMotorTempErrStatus: 반환값 0(정상)/1(에러)

---

### 2. CAN 모듈 (BswCan.h/c) - 가장 큰 변화

#### 🔄 채널 확장
```diff
// 듀얼 CAN 채널 지원
  #define BSWCAN_CAN_CH0			(0U)
+ #define BSWCAN_CAN_CH1			(1U)
```

#### 🔄 RX 인덱스 전면 교체
```diff
// V1.00 RX 인덱스 (삭제)
- #define BSWCAN_MSG_RX_INDEX_VPC_ARS_01_10ms		(0U) //Rx // 0x51C
- #define BSWCAN_MSG_RX_INDEX_SEA_ARS_01_1ms		(1U) //Rx // 0x51A
- #define BSWCAN_MSG_RX_INDEX_SEA_ARS_02_1ms		(2U) //Rx // 0x51B

// V1.01 RX 인덱스 (신규)
+ #define BSWCAN_MSG_RX_INDEX_MVPC_ARS_01_1ms		(0U) //Rx // 0x20
+ #define BSWCAN_MSG_RX_INDEX_ROUTING_01_10ms		(1U) //Rx // 0x27
+ #define BSWCAN_MSG_RX_INDEX_ROUTING_01_20ms		(2U) //Rx // 0x26
+ #define BSWCAN_MSG_RX_INDEX_ROUTING_01_200ms	(3U) //Rx // 0x25
```

#### 🔄 TX 인덱스 확장 및 재구성
```diff
// V1.00 TX 인덱스 (대부분 삭제)
- #define BSWCAN_MSG_TX_INDEX_ARS_dev_01_10ms		(0U) //Tx // 0x514
- #define BSWCAN_MSG_TX_INDEX_ARS_dev_02_1ms		(1U) //Tx // 0x515
- #define BSWCAN_MSG_TX_INDEX_ARS_dev_03_10ms		(2U) //Tx // 0x516
- #define BSWCAN_MSG_TX_INDEX_ARS_dev_04_10ms		(3U) //Tx // 0x517

// V1.01 TX 인덱스 (새로운 MEAS 계열 + ARS_dev 1개 잔존)
+ #define BSWCAN_MSG_TX_INDEX_MEAS_01_1ms			(0U) //Tx 0x401
+ #define BSWCAN_MSG_TX_INDEX_MEAS_01_5ms			(1U) //Tx 0x402
+ #define BSWCAN_MSG_TX_INDEX_MEAS_02_5ms			(2U) //Tx 0x403
+ #define BSWCAN_MSG_TX_INDEX_MEAS_01_10ms		(3U) //Tx 0x404
+ #define BSWCAN_MSG_TX_INDEX_MEAS_02_10ms		(4U) //Tx 0x405
+ #define BSWCAN_MSG_TX_INDEX_ARS_dev_01_1ms		(5U) //Tx Front: 0x21, Rear: 0x22
```

#### 🔄 구조체 타입 전면 교체
**V1.00에서 삭제된 구조체:**
- `typBswCanMsg_VPC1` (기존)
- `typBswCanMsg_SEA1`
- `typBswCanMsg_SEA2`
- `typBswCanMsg_ARS2`
- `typBswCanMsg_ARS3`
- `typBswCanMsg_ARS4`

**V1.01에서 신규 추가된 구조체:**
- `typBswCanMsg_MEAS` (MEAS 메시지용, 32바이트)
- `typBswCanMsg_MVPC1` (MVPC 메시지용, 16바이트)
- `typBswCanMsg_RT1_10` (ROUTING 10ms, 24바이트)
- `typBswCanMsg_RT1_20` (ROUTING 20ms, 8바이트)
- `typBswCanMsg_RT1_200` (ROUTING 200ms, 8바이트)
- `typBswCanMsg_ARS1` (재정의, 16바이트)

#### ➕ 신규 제어 API
```c
extern void ShrHWIA_BswCan_SetTimeoutMax(uint8 msg_index, uint32 timeout_max);
extern void ShrHWIA_BswCan_SetCh0CanDisable(uint8 disable);
```

#### 📝 엑셀 반영 내용
**01_IF_BSW→ASW 시트:**
- RX 메시지 테이블 전면 교체:
  - 기존 VPC/SEA 행들 모두 삭제
  - 신규 MVPC_ARS_01_1ms (인덱스 0, ID 0x20, 주기 1ms)
  - 신규 ROUTING_01_10ms (인덱스 1, ID 0x27, 주기 10ms)
  - 신규 ROUTING_01_20ms (인덱스 2, ID 0x26, 주기 20ms)
  - 신규 ROUTING_01_200ms (인덱스 3, ID 0x25, 주기 200ms)

**02_IF_ASW→BSW 시트:**
- TX 메시지 테이블 확장:
  - 기존 ARS_dev 01~04 행들 삭제
  - 신규 MEAS 계열 5개 추가 (인덱스 0~4, ID 0x401~0x405)
  - ARS_dev_01_1ms 1개만 잔존 (인덱스 5, Front: 0x21, Rear: 0x22)
- 신규 제어 API 2개 추가:
  1. SetTimeoutMax: 메시지별 타임아웃 동적 설정
  2. SetCh0CanDisable: CAN CH0 송신 활성화/비활성화

---

### 3. DIO 모듈 (BswDio.h/c) - 대폭 확장

#### 🔄 채널 정의 대폭 확장
```diff
// V1.00 (8개 채널)
  #define BSWDIO_CH_TP158           (0U)
  #define BSWDIO_CH_TP29            (1U)
  #define BSWDIO_CH_TP31            (2U)
  #define BSWDIO_CH_TP48            (3U)
- #define BSWDIO_CH_TP50            (4U)
- #define BSWDIO_CH_TP51            (5U)
  #define BSWDIO_CH_TP52            (6U) → (4U)
- #define BSWDIO_CH_TP53            (7U)

// V1.01 (24개 채널로 대폭 확장)
+ #define BSWDIO_CH_TP2             (5U)
+ #define BSWDIO_CH_TP4             (6U)
+ #define BSWDIO_CH_TP20            (7U)
+ #define BSWDIO_CH_TP50            (8U)
+ #define BSWDIO_CH_TP51            (9U)
+ #define BSWDIO_CH_TP62            (10U)
+ #define BSWDIO_CH_TP65            (11U)
+ #define BSWDIO_CH_TP76            (12U)
+ #define BSWDIO_CH_TP77            (13U)
+ #define BSWDIO_CH_TP78            (14U)
+ #define BSWDIO_CH_TP98            (15U)
+ #define BSWDIO_CH_TP100           (16U)
+ #define BSWDIO_CH_TP53            (17U)
+ #define BSWDIO_CH_SENS_INTERLOCK  (18U)
+ #define BSWDIO_CH_DRV_FAULT       (19U)
+ #define BSWDIO_CH_CURR_FLT_SENS_U (20U)
+ #define BSWDIO_CH_CURR_FLT_SENS_W (21U)
+ #define BSWDIO_CH_CURR_FLT_SENS_HVB (22U)
+ #define BSWDIO_CH_HV_OV_SENS      (23U)
```

#### ➕ 신규 API
```c
extern void BswDio_LED_Diable(void);  // LED 비활성화 함수 추가
```

#### 📝 엑셀 반영 내용
**01_IF_BSW→ASW 시트:**
- DIO 채널 테이블 대폭 확장 (8개→24개):
  - 기존 TP 핀들 인덱스 일부 변경
  - 신규 TP 핀들 다수 추가 (TP2, TP4, TP20 등)
  - 신규 센서/상태 핀들 추가:
    - SENS_INTERLOCK (18): 인터록 센서
    - DRV_FAULT (19): 드라이버 오류
    - CURR_FLT_SENS_U/W/HVB (20~22): 전류 오류 센서
    - HV_OV_SENS (23): 고전압 과전압 센서

**02_IF_ASW→BSW 시트:**
- LED 제어 API에 LED_Disable 함수 추가

---

### 4. SENT 모듈 (BswSent.h/c)

#### 🔄 기존 함수 시그니처 변경
```diff
// GetGearPosition 함수 파라미터 변경
- extern typBswSent_StateType ShrHWIA_BswSent_GetGearPosition(uint16* sentdata);
+ extern typBswSent_StateType ShrHWIA_BswSent_GetGearPosition(uint16* outdata1, uint8* outdata2);
```

#### ➕ 신규 API
```c
#include "Std_Types.h"  // 새로운 헤더 추가
extern Std_ReturnType ShrHWIA_BswSent_GetSlowChannel(uint8 msgid, uint16* outdata, uint32* outtimestamp);
```

#### 📝 엑셀 반영 내용
**01_IF_BSW→ASW 시트:**
- GetGearPosition 함수 수정: 출력 파라미터 2개로 변경
- 신규 GetSlowChannel 함수 추가:
  - 입력: msgid (22개 ID 지원)
  - 출력: data (16bit), timestamp (32bit)
  - 반환: Std_ReturnType (E_OK/E_NOT_OK)

---

### 5. SYS 모듈 (BswSys.h/c)

#### ➕ 신규 상수 정의
```c
#define BSWSYS_TARGET_AXLE_UNDEFINED		(0U)
#define BSWSYS_TARGET_AXLE_FRONT			(1U)
#define BSWSYS_TARGET_AXLE_REAR				(2U)
```

#### ➕ 신규 API (3개)
```c
extern void ShrHWIA_BswSys_SetTargetAxle(uint8 axle);
extern uint8 ShrHWIA_BswSys_GetReproStatusFlag(void);
extern void ShrHWIA_BswSys_ShutdownRequest(void);
extern float32 ShrHWIA_BswSys_GetCpuLoad(void);
```

#### 📝 엑셀 반영 내용
**01_IF_BSW→ASW 시트:**
- 신규 GetReproStatusFlag: 재현 상태 플래그 반환
- 신규 GetCpuLoad: CPU 사용률 반환 (0.0~100.0%, 100ms 주기)

**02_IF_ASW→BSW 시트:**
- 신규 SetTargetAxle: 타겟 액슬 설정 (0:미정의, 1:전륜, 2:후륜)
- 신규 ShutdownRequest: 시스템 셧다운 요청

---

### 6. 변화 없는 모듈들

#### DAC, GPT, ICU 모듈
- **BswDac.h/c**: 변경사항 없음 (채널 4개, API 1개 유지)
- **BswGpt.h/c**: 변경사항 없음 (인코더 채널 1개, API 2개 유지)  
- **BswIcu.h/c**: 변경사항 없음 (PWM 채널 2개, API 2개 유지)

#### PWM 모듈 (BswPwm.h/c) - 소규모 변경
```diff
// 매크로 이름 일부 변경
- #define PWM_OUT_ENABLELOW_DISABLEHIGH		(0U)
- #define PWM_OUT_ENABLEHIGH_DISABLELOW		(1U)
- #define PWM_OUT_DISABLEHIGHLOW				(2U)
+ #define HD_LE					(0U)
+ #define HE_LD					(1U)
+ #define HD_LD					(2U)

// 함수 시그니처 변경
- extern void ShrHWIA_BswPwm_ChOutEnable(uint8 PwmCh, uint8 PwmOutSt, uint16 PwmOutVal);
+ extern uint8 ShrHWIA_BswPwm_Enable(uint8 EnableVal);  // 반환값 추가
+ extern void ShrHWIA_BswPwm_Channel_SetDutyCycle(uint8 PwmCh, uint8 PwmOutSt, uint16 PwmOutVal);  // 함수명 변경
```

#### IswHandler 모듈
```diff
// 신규 Init3 함수 추가
+ extern void ShrHWIA_IswHandler_Init3(void);
```

---

## 📊 엑셀 시트별 반영 가이드

### 1. 00_문서정보 시트

#### 수정 항목:
- **문서명**: ARS_BSW-ASW_Interface_V1.01.xlsx
- **버전**: V1.01  
- **작성일**: 2025-08-20
- **변경이력 추가**:
  ```
  V1.01 (2025-08-20): API 9개 추가, CAN 구조 전면 개편, DIO 채널 확장
  - ADC: RAW 채널 도입, 진단 API 2개 추가
  - CAN: RX/TX 인덱스 전면 교체, MEAS 계열 도입, 제어 API 2개 추가  
  - DIO: 채널 8개→24개 확장, 센서 채널 추가
  - SENT: SlowChannel API 추가, GearPosition 시그니처 변경
  - SYS: TargetAxle, Shutdown, CpuLoad API 추가
  ```

### 2. 01_IF_BSW→ASW 시트 (V1.00: 30개 → V1.01: 35개 API)

#### A. ADC 관련 수정
| 행 번호 | 함수명 | 채널/파라미터 | 반환값 | 설명 | 비고 |
|---------|--------|---------------|--------|------|------|
| 기존 | ShrHWIA_BswAdc_GetPhyValue | 채널 0: BSWADC_CH_SENS_CURR_U_RAW | float | 전류 U상 RAW | 기존 CURR_U에서 변경 |
| 기존 | ShrHWIA_BswAdc_GetPhyValue | 채널 1: BSWADC_CH_SENS_CURR_W_RAW | float | 전류 W상 RAW | 기존 CURR_V 삭제, CURR_W에서 변경 |
| 기존 | ShrHWIA_BswAdc_GetPhyValue | 채널 2: BSWADC_CH_SENS_CURR_DC_RAW | float | 전류 DC RAW | 신규 추가 |
| 기존 | ShrHWIA_BswAdc_GetPhyValue | 채널 8: BSWADC_CH_VUC_5V0 | float | VUC 5V0 전압 | 기존 3V3에서 변경 |
| 신규 | ShrHWIA_BswAdc_GetCurrentCalibStatus | void | uint8 | 전류 캘리브레이션 상태 | 0:진행중, 1:성공, 2:실패 |
| 신규 | ShrHWIA_BswAdc_GetMotorTempErrStatus | void | uint8 | 모터 온도 센서 에러 | 0:정상, 1:에러 |

#### B. CAN 관련 수정 (RX 메시지)
| 행 번호 | 함수명 | 인덱스 | CAN ID | 주기 | DLC | 설명 | 비고 |
|---------|--------|--------|--------|------|-----|------|------|
| 삭제 | ~~ShrHWIA_BswCan_GetMsg~~ | ~~INDEX_VPC_ARS_01_10ms~~ | ~~0x51C~~ | ~~10ms~~ | ~~8~~ | VPC 메시지 | V1.00에서 제거 |
| 삭제 | ~~ShrHWIA_BswCan_GetMsg~~ | ~~INDEX_SEA_ARS_01_1ms~~ | ~~0x51A~~ | ~~1ms~~ | ~~16~~ | SEA 메시지1 | V1.00에서 제거 |
| 삭제 | ~~ShrHWIA_BswCan_GetMsg~~ | ~~INDEX_SEA_ARS_02_1ms~~ | ~~0x51B~~ | ~~1ms~~ | ~~24~~ | SEA 메시지2 | V1.00에서 제거 |
| 신규 | ShrHWIA_BswCan_GetMsg | INDEX_MVPC_ARS_01_1ms (0) | 0x20 | 1ms | 16 | MVPC 메시지 | V1.01 신규 |
| 신규 | ShrHWIA_BswCan_GetMsg | INDEX_ROUTING_01_10ms (1) | 0x27 | 10ms | 24 | 라우팅 10ms | V1.01 신규 |
| 신규 | ShrHWIA_BswCan_GetMsg | INDEX_ROUTING_01_20ms (2) | 0x26 | 20ms | 8 | 라우팅 20ms | V1.01 신규 |
| 신규 | ShrHWIA_BswCan_GetMsg | INDEX_ROUTING_01_200ms (3) | 0x25 | 200ms | 8 | 라우팅 200ms | V1.01 신규 |

#### C. DIO 관련 확장
| 행 번호 | 함수명 | 채널 | 설명 | 비고 |
|---------|--------|------|------|------|
| 기존 | ShrHWIA_BswDio_GetPin/SetPin | 0~17 | TP 핀들 | 일부 인덱스 변경 |
| 신규 | ShrHWIA_BswDio_GetPin | 18: BSWDIO_CH_SENS_INTERLOCK | 인터록 센서 | 안전 관련 |
| 신규 | ShrHWIA_BswDio_GetPin | 19: BSWDIO_CH_DRV_FAULT | 드라이버 오류 | 진단 신호 |
| 신규 | ShrHWIA_BswDio_GetPin | 20: BSWDIO_CH_CURR_FLT_SENS_U | 전류 오류 센서 U상 | 전류 진단 |
| 신규 | ShrHWIA_BswDio_GetPin | 21: BSWDIO_CH_CURR_FLT_SENS_W | 전류 오류 센서 W상 | 전류 진단 |
| 신규 | ShrHWIA_BswDio_GetPin | 22: BSWDIO_CH_CURR_FLT_SENS_HVB | 전류 오류 센서 HVB | 전류 진단 |
| 신규 | ShrHWIA_BswDio_GetPin | 23: BSWDIO_CH_HV_OV_SENS | 고전압 과전압 센서 | 전압 진단 |

#### D. SENT 관련 수정
| 행 번호 | 함수명 | 파라미터 | 반환값 | 설명 | 비고 |
|---------|--------|----------|--------|------|------|
| 수정 | ShrHWIA_BswSent_GetGearPosition | uint16* outdata1, uint8* outdata2 | typBswSent_StateType | 기어 위치 | 파라미터 2개로 변경 |
| 신규 | ShrHWIA_BswSent_GetSlowChannel | uint8 msgid, uint16* outdata, uint32* outtimestamp | Std_ReturnType | SENT 슬로우 채널 | 22개 ID 지원 |

#### E. SYS 관련 추가
| 행 번호 | 함수명 | 파라미터 | 반환값 | 설명 | 비고 |
|---------|--------|----------|--------|------|------|
| 신규 | ShrHWIA_BswSys_GetReproStatusFlag | void | uint8 | 재현 상태 플래그 | 진단용 |
| 신규 | ShrHWIA_BswSys_GetCpuLoad | void | float32 | CPU 사용률 | 0.0~100.0%, 100ms 주기 |

#### F. IswHandler 관련 추가
| 행 번호 | 함수명 | 파라미터 | 반환값 | 설명 | 비고 |
|---------|--------|----------|--------|------|------|
| 신규 | ShrHWIA_IswHandler_Init3 | void | void | 3차 초기화 | 고급 기능 활성화 |

### 3. 02_IF_ASW→BSW 시트 (V1.00: 12개 → V1.01: 16개 API)

#### A. CAN 관련 수정 (TX 메시지)
| 행 번호 | 함수명 | 인덱스 | CAN ID | 주기 | DLC | 설명 | 비고 |
|---------|--------|--------|--------|------|-----|------|------|
| 삭제 | ~~ShrHWIA_BswCan_SetMsg~~ | ~~INDEX_ARS_dev_01_10ms~~ | ~~0x514/0x515~~ | ~~10ms~~ | ~~32~~ | 개발 메시지1 | V1.00에서 제거 |
| 삭제 | ~~ShrHWIA_BswCan_SetMsg~~ | ~~INDEX_ARS_dev_02_1ms~~ | ~~0x515/0x514~~ | ~~1ms~~ | ~~8~~ | 개발 메시지2 | V1.00에서 제거 |
| 삭제 | ~~ShrHWIA_BswCan_SetMsg~~ | ~~INDEX_ARS_dev_03_10ms~~ | ~~0x516~~ | ~~10ms~~ | ~~8~~ | 개발 메시지3 | V1.00에서 제거 |
| 삭제 | ~~ShrHWIA_BswCan_SetMsg~~ | ~~INDEX_ARS_dev_04_10ms~~ | ~~0x517~~ | ~~10ms~~ | ~~24~~ | 개발 메시지4 | V1.00에서 제거 |
| 신규 | ShrHWIA_BswCan_SetMsg | INDEX_MEAS_01_1ms (0) | 0x401 | 1ms | 32 | 측정 데이터 1ms | V1.01 신규 |
| 신규 | ShrHWIA_BswCan_SetMsg | INDEX_MEAS_01_5ms (1) | 0x402 | 5ms | 32 | 측정 데이터 5ms | V1.01 신규 |
| 신규 | ShrHWIA_BswCan_SetMsg | INDEX_MEAS_02_5ms (2) | 0x403 | 5ms | 32 | 측정 데이터 5ms-2 | V1.01 신규 |
| 신규 | ShrHWIA_BswCan_SetMsg | INDEX_MEAS_01_10ms (3) | 0x404 | 10ms | 32 | 측정 데이터 10ms | V1.01 신규 |
| 신규 | ShrHWIA_BswCan_SetMsg | INDEX_MEAS_02_10ms (4) | 0x405 | 10ms | 32 | 측정 데이터 10ms-2 | V1.01 신규 |
| 유지 | ShrHWIA_BswCan_SetMsg | INDEX_ARS_dev_01_1ms (5) | Front: 0x21, Rear: 0x22 | 1ms | 16 | 개발 메시지 (유일 잔존) | 액슬별 ID 분리 |

#### B. CAN 제어 API 추가
| 행 번호 | 함수명 | 파라미터 | 반환값 | 설명 | 비고 |
|---------|--------|----------|--------|------|------|
| 신규 | ShrHWIA_BswCan_SetTimeoutMax | uint8 msg_index, uint32 timeout_max | void | 메시지별 타임아웃 설정 | 동적 제어 |
| 신규 | ShrHWIA_BswCan_SetCh0CanDisable | uint8 disable | void | CAN CH0 송신 제어 | 0:활성화, 1:비활성화 |

#### C. SYS 제어 API 추가
| 행 번호 | 함수명 | 파라미터 | 반환값 | 설명 | 비고 |
|---------|--------|----------|--------|------|------|
| 신규 | ShrHWIA_BswSys_SetTargetAxle | uint8 axle | void | 타겟 액슬 설정 | 0:미정의, 1:전륜, 2:후륜 |
| 신규 | ShrHWIA_BswSys_ShutdownRequest | void | void | 시스템 셧다운 요청 | 안전 셧다운 |

#### D. DIO 제어 API 추가
| 행 번호 | 함수명 | 파라미터 | 반환값 | 설명 | 비고 |
|---------|--------|----------|--------|------|------|
| 신규 | BswDio_LED_Diable | void | void | LED 비활성화 | 기존 LED_Indicate와 쌍 |

#### E. PWM 관련 수정
| 행 번호 | 함수명 | 파라미터 | 반환값 | 설명 | 비고 |
|---------|--------|----------|--------|------|------|
| 수정 | ShrHWIA_BswPwm_Enable | uint8 EnableVal | uint8 | PWM 활성화 | 반환값 추가 |
| 수정 | ShrHWIA_BswPwm_Channel_SetDutyCycle | uint8 PwmCh, uint8 PwmOutSt, uint16 PwmOutVal | void | 채널별 듀티 설정 | 함수명 변경 |

---

## 🗺️ API 매핑 테이블

### 변경된 API 매핑
| V1.00 함수/상수 | V1.01 함수/상수 | 변경 유형 | 비고 |
|-----------------|-----------------|----------|------|
| BSWADC_CH_SENS_CURR_U | BSWADC_CH_SENS_CURR_U_RAW | 이름 변경 | RAW 접미 추가 |
| BSWADC_CH_SENS_CURR_V | 삭제 | 삭제 | V상 전류 제거 |
| BSWADC_CH_SENS_CURR_W | BSWADC_CH_SENS_CURR_W_RAW | 이름 변경 | RAW 접미 추가 |
| BSWADC_CH_VUC_3V3 | BSWADC_CH_VUC_5V0 | 전압 변경 | 3.3V → 5V |
| BSWCAN_MSG_RX_INDEX_VPC_ARS_01_10ms | BSWCAN_MSG_RX_INDEX_MVPC_ARS_01_1ms | 완전 교체 | VPC → MVPC |
| BSWCAN_MSG_RX_INDEX_SEA_ARS_01_1ms | BSWCAN_MSG_RX_INDEX_ROUTING_01_10ms | 완전 교체 | SEA → ROUTING |
| BSWCAN_MSG_TX_INDEX_ARS_dev_01_10ms | BSWCAN_MSG_TX_INDEX_MEAS_01_1ms | 완전 교체 | ARS_dev → MEAS |
| ShrHWIA_BswSent_GetGearPosition(uint16*) | ShrHWIA_BswSent_GetGearPosition(uint16*, uint8*) | 시그니처 변경 | 파라미터 2개로 증가 |
| ShrHWIA_BswPwm_ChOutEnable | ShrHWIA_BswPwm_Channel_SetDutyCycle | 함수명 변경 | 명명 규칙 통일 |

### 완전 신규 API 목록
| 신규 API | 모듈 | 기능 | 반환값 |
|----------|------|------|--------|
| ShrHWIA_BswAdc_GetCurrentCalibStatus | ADC | 전류 캘리브레이션 상태 | uint8 (0~2) |
| ShrHWIA_BswAdc_GetMotorTempErrStatus | ADC | 모터 온도 센서 에러 | uint8 (0~1) |
| ShrHWIA_BswCan_SetTimeoutMax | CAN | 메시지 타임아웃 설정 | void |
| ShrHWIA_BswCan_SetCh0CanDisable | CAN | CAN CH0 송신 제어 | void |
| ShrHWIA_BswSent_GetSlowChannel | SENT | SENT 슬로우 채널 | Std_ReturnType |
| ShrHWIA_BswSys_SetTargetAxle | SYS | 타겟 액슬 설정 | void |
| ShrHWIA_BswSys_GetReproStatusFlag | SYS | 재현 상태 플래그 | uint8 |
| ShrHWIA_BswSys_ShutdownRequest | SYS | 시스템 셧다운 요청 | void |
| ShrHWIA_BswSys_GetCpuLoad | SYS | CPU 사용률 | float32 |
| ShrHWIA_IswHandler_Init3 | IswHandler | 3차 초기화 | void |
| BswDio_LED_Diable | DIO | LED 비활성화 | void |

---

## ✅ 검증 체크리스트

### 📄 문서 검증
- [ ] 00_문서정보 시트: 버전, 날짜, 변경이력 업데이트
- [ ] 01_IF_BSW→ASW 시트: 35개 API 정확히 반영
- [ ] 02_IF_ASW→BSW 시트: 16개 API 정확히 반영

### 🔧 ADC 모듈 검증
- [ ] 채널 매크로: CURR_U/W_RAW, VUC_5V0 반영
- [ ] 신규 상수: CALIB_* , MOTOR_TEMP_* 정의 추가
- [ ] 신규 API: GetCurrentCalibStatus, GetMotorTempErrStatus 추가

### 📡 CAN 모듈 검증
- [ ] 채널: CH1 추가 확인
- [ ] RX 인덱스: MVPC, ROUTING 계열로 완전 교체
- [ ] TX 인덱스: MEAS 계열 5개 + ARS_dev 1개만 잔존
- [ ] 구조체: typBswCanMsg_MEAS, MVPC1, RT1_* 신규 정의
- [ ] 제어 API: SetTimeoutMax, SetCh0CanDisable 추가
- [ ] DLC 값: MEAS 32바이트, ARS_dev 16바이트 확인

### 🔌 DIO 모듈 검증
- [ ] 채널 확장: 8개→24개 정확히 반영
- [ ] 센서 채널: INTERLOCK, DRV_FAULT, CURR_FLT_*, HV_OV_SENS 추가
- [ ] LED API: LED_Diable 함수 추가

### 📶 SENT 모듈 검증
- [ ] GetGearPosition: 파라미터 2개로 시그니처 변경
- [ ] GetSlowChannel: 22개 ID 지원, timestamp 출력 포함
- [ ] 헤더: Std_Types.h 추가 확인

### ⚙️ SYS 모듈 검증
- [ ] 상수: TARGET_AXLE_* 정의 추가
- [ ] 신규 API: SetTargetAxle, GetReproStatusFlag, ShutdownRequest, GetCpuLoad
- [ ] CPU Load: 100ms 주기, float32 반환 명시

### 🔄 PWM 모듈 검증
- [ ] 매크로: HD_LE, HE_LD, HD_LD로 변경
- [ ] Enable 함수: uint8 반환값 추가
- [ ] Channel_SetDutyCycle: 함수명 변경 확인

### 🚀 IswHandler 검증
- [ ] Init3 함수: 3차 초기화 추가

### 📐 DLC 및 주기 검증
- [ ] MEAS 메시지: 32바이트 DLC 확인
- [ ] ROUTING 메시지: 10ms(24바이트), 20ms(8바이트), 200ms(8바이트)
- [ ] MVPC 메시지: 1ms 주기, 16바이트
- [ ] ARS_dev_01: 1ms 주기, 16바이트, Front/Rear ID 분리

---

## 🚨 주의사항 및 리스크

### ⚠️ 호환성 주의사항
1. **ADC 채널 매크로 변경**: 기존 코드에서 CURR_U/V/W 사용 시 컴파일 에러
2. **CAN 인덱스 전면 교체**: 기존 VPC/SEA 인덱스 사용 코드 전면 수정 필요
3. **DIO 채널 인덱스 변경**: 일부 TP 핀 인덱스 변경으로 기존 코드 점검 필요
4. **SENT 함수 시그니처**: GetGearPosition 호출 코드 수정 필요

### 🔧 구현 검증 필요사항
1. **CAN 구조체 패킹**: MCU/컴파일러별 __packed__ 지원 확인
2. **SENT SlowChannel**: 22개 ID 범위 및 타임스탬프 단위 명시
3. **CPU Load 측정**: 100ms 윈도우 구현 방식 확인
4. **Target Axle 적용**: 시스템 초기화 시점에서의 설정 방법

### 🛡️ 안전 기능 관련
1. **Interlock 센서**: 안전 로직과의 연동 확인
2. **Shutdown Request**: IG ON 상태에서의 동작 제한 구현
3. **전류 오류 센서**: 실시간 진단 로직 구현 필요

---

## 📚 참고 자료

### 코드 위치
- V1.00 코드: `communication/shared/wia_ars/01_compare_old/HWAR650V3KW_BSW/Sourcecode`
- V1.01 코드: `communication/shared/wia_ars/00_compare_current/HWAR650V3KW_BSW/Sourcecode`

### 관련 문서
- `ARS_BSW-ASW_Interface_V1.01_CHANGES.md`: 변경점 요약
- `V1.00_to_V1.01_작업가이드.md`: 기존 작업 가이드 (불완전)
- `V1.00_to_V1.01_코드기반_업데이트_가이드.md`: CODEX 작성 가이드 (불완전)

---

**✅ 완료:** 본 문서는 V1.00과 V1.01의 실제 코드를 완전히 비교 분석하여 작성되었습니다. 엑셀 명세서 작성 시 이 가이드를 기준으로 정확한 반영이 가능합니다.