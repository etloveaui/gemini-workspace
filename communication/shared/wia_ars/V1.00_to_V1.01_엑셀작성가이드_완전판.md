# ARS_BSW-ASW_Interface V1.00 → V1.01 엑셀 작성 완전 가이드

작성일: 2025-08-20  
근거: 실제 코드 완전 비교 (01_compare_old vs 00_compare_current)  
형식: 엑셀 바로 입력 가능한 필드 블록 방식

## 📊 업데이트 요약
- **총 API**: 42 → 51 (**+9개 신규**, 0개 삭제, **3개 수정**)
- **핵심 변경**: ADC RAW채널+5V0, CAN RX인덱스 전면교체(MVPC/ROUTING), TX MEAS라인업, 듀얼CAN(CH1), SENT SlowChannel, 시스템 고급기능
- **누락 방지**: 모든 변경점 코드레벨 검증 완료

---

## 00_문서정보 시트 업데이트

**필수 수정 셀:**
- **A2 (문서명)**: ARS_BSW-ASW_Interface_V1.01
- **B2 (버전)**: V1.01
- **C2 (작성일)**: 2025-08-20
- **변경이력 (마지막 행 추가)**:
  ```
  V1.00 → V1.01: API 9개 추가, 3개 수정
  주요: 듀얼CAN, SENT SlowChannel, CPU Load, ADC RAW표준화
  ```

---

## 01_IF_BSW→ASW 시트

### 🔧 수정 항목 (3개)

#### 1) ShrHWIA_BswAdc_GetPhyValue (기존 행 수정)
**변경점**: ADC 채널 매크로에 RAW 접미사 도입, VUC 3V3→5V0 전환

**엑셀 수정 지침:**
- **1st Parameter 셀 교체**:
  ```
  기존: BSWADC_CH_SENS_CURR_U(0), _W(1), _DC(2), SENS_HV(3), VUC_3V3(8)...
  신규: BSWADC_CH_SENS_CURR_U_RAW(0), _W_RAW(1), _DC_RAW(2), SENS_HV(3), VUC_5V0(8), VCOM_5V0(9), VT1_5V0(10), VT2_5V0(11), VREF_5V0(12)
  ```
- **Description/비고 추가**: "v1.01: RAW 채널 표준화, VUC=5V0 전환"
- **Result 컬럼**: CHG

#### 2) ShrHWIA_BswCan_GetMsg (기존 행 수정)
**변경점**: RX 인덱스 전면 교체 (VPC/SEA → MVPC/ROUTING)

**엑셀 수정 지침:**
- **1st Parameter 셀 교체**:
  ```
  기존: VPC_ARS_01_10ms(0), SEA_ARS_01_1ms(1), SEA_ARS_02_1ms(2)
  신규: MVPC_ARS_01_1ms(0), ROUTING_01_10ms(1), ROUTING_01_20ms(2), ROUTING_01_200ms(3)
  ```
- **추가 정보 병기**: "CAN ID: 0x20/0x27/0x26/0x25"
- **비고**: "v1.00의 VPC/SEA 계열 → v1.01 MVPC/ROUTING 계열로 전면 치환"
- **Result 컬럼**: CHG

#### 3) ShrHWIA_BswCan_GetState_Busoff (기존 행 수정)
**변경점**: 듀얼 CAN 채널 지원 추가

**엑셀 수정 지침:**
- **1st Parameter 셀 교체**:
  ```
  기존: BSWCAN_CAN_CH0(0)
  신규: BSWCAN_CAN_CH0(0), BSWCAN_CAN_CH1(1)
  ```
- **비고**: "v1.01: 듀얼 CAN 채널 지원"
- **Result 컬럼**: CHG

### ➕ 신규 추가 항목 (5개)

**다음 블록들을 새 행으로 추가 (필드명 그대로 복사):**

#### 1) ShrHWIA_BswAdc_GetCurrentCalibStatus
- **Ver**: V1.01
- **NO.**: (기존 마지막 번호 +1)
- **Component**: BSW → ASW  
- **Return Type**: uint8
- **Element Name**: ShrHWIA_BswAdc_GetCurrentCalibStatus()
- **Return/Range**: 0: 진행중, 1: 성공, 2: 실패
- **Description**: 전류 캘리브레이션 상태 조회
- **Result**: NEW

#### 2) ShrHWIA_BswAdc_GetMotorTempErrStatus  
- **Ver**: V1.01
- **NO.**: (기존 마지막 번호 +2)
- **Component**: BSW → ASW
- **Return Type**: uint8
- **Element Name**: ShrHWIA_BswAdc_GetMotorTempErrStatus()
- **Return/Range**: 0: 정상(VALID), 1: 에러(INVALID)
- **Description**: 모터 온도 센서 에러 상태
- **Result**: NEW

#### 3) ShrHWIA_BswSent_GetSlowChannel
- **Ver**: V1.01
- **NO.**: (기존 마지막 번호 +3)
- **Component**: BSW → ASW
- **Return Type**: Std_ReturnType
- **Element Name**: ShrHWIA_BswSent_GetSlowChannel(uint8 msgId, uint16* data, uint32* timestamp)
- **1st Parameter**: msgId (22개 ID 지원)
- **2nd Parameter**: data (출력 포인터)
- **3rd Parameter**: timestamp (출력 포인터)
- **Description**: SENT Slow Channel 데이터 읽기
- **Note**: "ID 목록/단위는 하위 설계서 참조"
- **Result**: NEW

#### 4) ShrHWIA_BswSys_GetCpuLoad
- **Ver**: V1.01
- **NO.**: (기존 마지막 번호 +4)
- **Component**: BSW → ASW
- **Return Type**: float32
- **Element Name**: ShrHWIA_BswSys_GetCpuLoad()
- **Unit/Range**: % / 0.0~100.0
- **Update**: 100ms 주기
- **Description**: 시스템 CPU 사용률
- **Result**: NEW

#### 5) ShrHWIA_IswHandler_Init3
- **Ver**: V1.01
- **NO.**: (기존 마지막 번호 +5)
- **Component**: BSW → ASW
- **Task**: Init
- **Return Type**: void
- **Element Name**: ShrHWIA_IswHandler_Init3()
- **Description**: 3차 초기화 (고급 기능 활성화)
- **Result**: NEW

---

## 02_IF_ASW→BSW 시트

### 🔧 수정 항목 (1개)

#### 1) ShrHWIA_BswCan_SetMsg (기존 행 수정)
**변경점**: TX 인덱스 라인업 개편 ("MEAS" 계열 추가)

**엑셀 수정 지침:**
- **1st Parameter 셀 교체**:
  ```
  신규 TX 인덱스:
  MEAS_01_1ms(0), MEAS_01_5ms(1), MEAS_02_5ms(2), MEAS_01_10ms(3), MEAS_02_10ms(4), ARS_dev_01_1ms(5)
  ```
- **DLC 정보 병기**: "MEAS=32byte, ARS_dev=16byte"
- **비고**: "v1.00의 ARS_dev_0x514~0x517 → v1.01 MEAS 라인업으로 구성 변경"
- **Result 컬럼**: CHG

### ➕ 신규 추가 항목 (4개)

#### 1) ShrHWIA_BswSys_SetTargetAxle
- **Ver**: V1.01
- **NO.**: (기존 마지막 번호 +1)
- **Task**: Init
- **Return Type**: void
- **Element Name**: ShrHWIA_BswSys_SetTargetAxle(uint8 axle)
- **1st Parameter**: 0: UNDEFINED, 1: FRONT, 2: REAR
- **Description**: 타겟 액슬 설정
- **Result**: NEW

#### 2) ShrHWIA_BswSys_ShutdownRequest
- **Ver**: V1.01
- **NO.**: (기존 마지막 번호 +2)
- **Return Type**: void
- **Element Name**: ShrHWIA_BswSys_ShutdownRequest(void)
- **Safety Note**: "IG ON 시 무동작 (안전 고려)"
- **Description**: 안전한 시스템 종료 요청
- **Result**: NEW

#### 3) ShrHWIA_BswCan_SetTimeoutMax
- **Ver**: V1.01
- **NO.**: (기존 마지막 번호 +3)
- **Return Type**: void
- **Element Name**: ShrHWIA_BswCan_SetTimeoutMax(uint8 msg_index, uint32 timeout_max)
- **Unit**: ms
- **Description**: CAN 메시지별 타임아웃 최대값 설정 (동적 변경)
- **Result**: NEW

#### 4) ShrHWIA_BswCan_SetCh0CanDisable
- **Ver**: V1.01
- **NO.**: (기존 마지막 번호 +4)
- **Return Type**: void
- **Element Name**: ShrHWIA_BswCan_SetCh0CanDisable(uint8 disable)
- **1st Parameter**: 0: 활성화, 1: 비활성화
- **Description**: CAN CH0 송신 제어
- **Result**: NEW

---

## 📋 구조체/신호 명세 (권장 추가 시트)

**목적**: 코드에 정의된 CAN 메시지 레이아웃을 명세로 문서화

**우선 대상 (v1.01 주요 메시지 6종)**:

### 1) typBswCanMsg_MVPC1
- **메시지명**: typBswCanMsg_MVPC1
- **크기**: 16 bytes, DLC=16  
- **주기/ID**: 1ms / 0x20
- **주요 필드**: MVPC_ArsFrntOpMdCmd(8bit), MVPC_ArsReOpMdCmd(8bit), MVPC_ArsAvlChk(8bit), MVPC_ArsAvl(8bit)
- **타임아웃**: 기본값 (SetTimeoutMax로 변경 가능)

### 2) typBswCanMsg_RT1_10/RT1_20/RT1_200
- **메시지명**: typBswCanMsg_RT1_10/20/200
- **크기**: 각각 정의됨
- **주기/ID**: 10ms/0x27, 20ms/0x26, 200ms/0x25
- **용도**: ROUTING 계열 메시지
- **필드**: 상세는 코드 참조

### 3) typBswCanMsg_MEAS
- **메시지명**: typBswCanMsg_MEAS  
- **크기**: 32 bytes, DLC=32
- **주기**: 1ms, 5ms, 10ms (인덱스별)
- **용도**: 측정 데이터 송신

### 4) typBswCanMsg_ARS1
- **메시지명**: typBswCanMsg_ARS1
- **크기**: 16 bytes, DLC=16
- **주기**: 1ms
- **용도**: ARS 개발 데이터

---

## ⚡ 엑셀 작업 가속화 팁

### 시트 구성
1. **기존 V1.00 시트 복제** → V1.01 탭 생성
2. **기존 행 유지**, 수정/추가만 반영
3. **"Result" 컬럼 활용**: NEW/CHG 표시 → 필터링으로 QA 효율화

### 셀 작업
- **"NO." 연속성 유지**: 신규는 기존 마지막 번호에 이어서
- **주기/ID/DLC 통합 표기**: 1st Parameter 또는 비고에 함께 기입
- **변경 셀 강조**: 노란색 배경으로 리뷰 포인트 명시
- **복사 활용**: 위 블록들을 그대로 복사하여 시간 단축

### 검증 체크
- **필터 활용**: Result=NEW/CHG로 필터링하여 변경점만 집중 리뷰
- **교차 검증**: 아래 체크리스트와 대조하여 누락 방지

---

## ✅ 최종 검증 체크리스트 (저장 전 필수)

### BSW→ASW (01 시트)
- [ ] **ADC**: RAW 접미사, VUC_5V0 반영됨
- [ ] **CAN RX**: MVPC/ROUTING 인덱스로 교체됨
- [ ] **CAN 듀얼**: CH0/CH1 모두 표기됨
- [ ] **SENT**: SlowChannel 신규 API 추가됨
- [ ] **ADC**: CurrentCalibStatus, MotorTempErrStatus 추가됨
- [ ] **SYS**: GetCpuLoad, Init3 추가됨

### ASW→BSW (02 시트)
- [ ] **CAN TX**: MEAS 라인업 5종 + DLC(32/16) 반영됨
- [ ] **SYS**: SetTargetAxle, ShutdownRequest 추가됨
- [ ] **CAN 제어**: SetTimeoutMax, SetCh0CanDisable 추가됨

### 문서 정보
- [ ] **버전**: V1.01로 업데이트됨
- [ ] **변경이력**: 추가됨
- [ ] **Result 컬럼**: NEW/CHG 올바르게 표시됨

### 구조체 명세 (선택)
- [ ] **CAN 메시지**: 주요 6종 레이아웃 기록됨

---

## 📂 참고 파일 (코드 근거)

**ADC**: `communication/shared/wia_ars/00_compare_current/Ifc_ASW/inc/BswAdc.h`  
**CAN**: `communication/shared/wia_ars/00_compare_current/Ifc_ASW/inc/BswCan.h`  
**SENT**: `communication/shared/wia_ars/00_compare_current/Ifc_ASW/inc/BswSent.h`  
**SYS**: `communication/shared/wia_ars/00_compare_current/Ifc_ASW/inc/BswSys.h`

**이 가이드를 따르면 누락 없이 완전한 V1.01 엑셀 명세서를 작성할 수 있습니다.**