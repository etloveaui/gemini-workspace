# GEMINI.md (v2 Final+)

## 0) 紐⑹쟻/踰붿쐞
蹂?臾몄꽌?????뚰겕?ㅽ럹?댁뒪??**?댁쁺 ?쒖?**?대떎. 紐⑺몴??**?ы쁽??*, **蹂댁븞**, **?좎냽???몄닔?멸퀎**?? 紐⑤뱺 洹쒖젙? Windows ?섍꼍怨?Python/Invoke 以묒떖?쇰줈 ?뺤쓽?쒕떎.

## 1) ?댁쁺 ?먯튃 (Windows-first)
- **Python 寃쎈줈**: venv媛 ?덉쑝硫?`%REPO%/venv/Scripts/python.exe`, ?놁쑝硫?`sys.executable`.
- **???몄퐫??*: PowerShell ?섑븨 湲덉?, ?뚯씠???꾨줈?몄뒪 **吏곸젒 ?몄텧**. ?쒖? I/O??**UTF-8** 怨좎젙.
- **?묒뾽 寃쎄퀎**: ?뚯씪 ?묒뾽? ?먯튃?곸쑝濡?**?덊룷 寃쎈줈 ?대?**?먯꽌 ?섑뻾?쒕떎.

## HUB ?묒뾽 ?섎챸二쇨린(?먮룞 愿由?
- ?쒖옉 ???깅줉 ???대젅?????꾨즺 蹂닿퀬(?깃났/?ㅽ뙣)濡??쇨? 愿由ы빀?덈떎.
- Invoke ?쒖뒪???먮뒗 釉뚮줈而??ㅽ겕由쏀듃瑜??ъ슜?섎ŉ, 鍮꾨??붿떇 ?섍꼍?먯꽌?????꾩뭅?대툕 JSON???먯옄?곸쑝濡?湲곕줉???쇨??깆쓣 蹂댁옣?⑸땲??

## Git ??Pre-commit) ?뺤콉
- ?꾩뿭 ?좉?: `.agents/config.json`??`hooks.enabled`濡??꾩껜 ??on/off.
- ??뷀삎 ?꾨＼?꾪듃 ?뚰뵾: `invoke commit_safe --skip-diff-confirm` ?먮뒗 `SKIP_DIFF_CONFIRM=1` ?ㅼ젙???ъ슜?⑸땲??
  - ?몃? GUI ??Sourcetree ?? ?ъ슜 ??沅뚯옣: ??鍮꾪솢??`invoke git.set-hooks --off`).

## 2) ?붾젆?곕━쨌異붿쟻 ?뺤콉
- **`.gemini/`**: ?ㅼ젙쨌濡쒖뺄 鍮꾨? 蹂닿? ?꾩튂.  
  - **而ㅻ컠 湲덉?**: `*.creds*.json`, `*oauth*.*`, ?좏겙瑜섎뒗 **濡쒖뺄 ?꾩슜(local-only)** ?쇰줈 蹂닿??섍퀬 而ㅻ컠?섏? ?딅뒗??  
  - **異붿쟻 ?덉슜**: `.gemini/`?먯꽌 **`context_policy.yaml`留?* 踰꾩쟾 異붿쟻???덉슜?쒕떎.
- **`projects/`**: 濡쒖뺄 ?꾩슜 ?묒뾽 怨듦컙. **??긽 而ㅻ컠 湲덉?**(`.gitignore`?먯꽌 ?꾨㈃ 李⑤떒).
- **pre-commit 媛??*: `.githooks/pre-commit` + `scripts/hooks/precommit_secrets_guard.py`濡? 
  `.gemini/*(oauth|creds|token|secret|.json|.db|.sqlite|.pem|.p12|.key)` 諛?`projects/` **?ㅽ뀒?댁쭠 李⑤떒**.

## 3) 紐낅졊 ?쒖? (Invoke & GitHub Actions)
- **Invoke (濡쒖뺄)**:
  - **(沅뚯옣) ?몄뀡 ?쒖옉**: `gemini-session.ps1` ?ㅽ겕由쏀듃瑜??ㅽ뻾?섎㈃ UTF-8 ?ㅼ젙, ????먮룞 ?뱁솕 ???몄뀡 ?섍꼍???먮룞?쇰줈 援ъ꽦?⑸땲??
  - `invoke start`: ?섍꼍 ?먭?(doctor) ??HUB 釉뚮━????而⑦뀓?ㅽ듃 ?몃뜳??鍮뚮뱶
  - `invoke doctor`: ?뚯씠??沅뚰븳/?ㅽ듃?뚰겕/寃쎈줈/?몄퐫???먭?
  - `invoke help [section]`: ?꾩?留?異쒕젰
  - `invoke search -q "<吏덉쓽>"`: ??寃???붿빟
  - `invoke context.build` / `invoke context.query "<q>"`
  - `invoke test`: pytest ?ㅽ뻾
  - `invoke wip -m "<msg>"`: WIP 而ㅻ컠
  - `invoke end`: ?몄뀡 醫낅즺(?꾩뭅?대툕/濡쒓렇/HUB 媛깆떊)
- **GitHub Actions (?먭꺽)**:
  - `@gemini-cli <?붿껌>`: PR ?먮뒗 ?댁뒋???볤????듯빐 ?먭꺽 AI ?댁떆?ㅽ꽩?몄뿉寃??묒뾽??吏?쒗빀?덈떎. (?? `@gemini-cli ??肄붾뱶 由щ럭?댁쨾`)

**(濡쒖뺄 1???ㅼ젙)** pre-commit ???쒖꽦?? `git config core.hooksPath .githooks`

**Exit Codes (?쒖?)**
- **0** ?뺤긽 / **2** Provider 誘몄꽕?빧룸텋媛 / **4** ?덉쇅(湲고? ?ㅻ쪟)

## 4) ?몄뀡 ?쇱씠?꾩궗?댄겢
**Start**
1) `doctor` ?ㅽ뻾 ???듭떖 ?섏〈??沅뚰븳/?몄퐫???먭?  
2) `docs/HUB.md`??Active/Paused ?붿빟, `git status --porcelain` ?붿빟  
3) `context.build` ?ㅽ뻾(?몃뜳??理쒖떊??  
4) ?댁쟾 ?몄뀡??`__lastSession__` 釉붾줉???덉쑝硫??뺣━ ???쒖옉

**During (?묒뾽 ?뚮났???꾨줈?좎퐳)**
- **?묒뾽 遺꾪븷:** 蹂듭옟???묒뾽? 紐낇솗???섏쐞 紐⑺몴濡?遺꾪븷?섏뿬 ?쒖감?곸쑝濡??ㅽ뻾?쒕떎.
- **?ъ쟾/?ы썑 濡쒓렇:** 紐⑤뱺 ?꾧뎄 ?ㅽ뻾(?뱁엳 ?뚯씪 ?섏젙, 紐낅졊???ㅽ뻾) ?꾪썑濡??섎룄? 寃곌낵瑜?利됱떆 濡쒓렇濡?湲곕줉?쒕떎.
- **?ㅽ뙣 ??利됱떆 ?꾪솚:** ?숈씪???묎렐?쇰줈 2???곗냽 ?ㅽ뙣 ?? 利됱떆 ?ㅻⅨ ?닿껐梨낆쓣 紐⑥깋?쒕떎 (湲곗〈 3-Strikes Rule 媛뺥솕).
- **媛??紐낆떆:** 遺덊솗?ㅽ븳 ?곹솴?먯꽌??紐낆떆?곸쑝濡?媛?뺤쓣 ?ㅼ젙?섍퀬, 寃利?怨꾪쉷???④퍡 ?쒖떆?쒕떎.

**End**
- `.gitignore` ?곹깭 ?뺤씤, 誘몄빱諛?蹂寃쎌? `wip` 沅뚭퀬  
- HUB ?곹깭 媛깆떊(Active?봒aused), `__lastSession__` 釉붾줉???듭떖 ?붿빟 湲곕줉

## 5) 濡쒓퉭쨌?몄닔?멸퀎
- **以묒븰 ?덈툕**: `docs/HUB.md` ???묒뾽???쇱씠?꾩궗?댄겢??愿由ы븯??以묒븰 ?덈툕. 紐⑤뱺 ?묒뾽? ?꾨옒 5媛吏 ?곹깭 以??섎굹瑜?媛吏묐땲??
  - **`Active` (?쒖꽦)**: ?꾩옱 理쒖슦?좎쑝濡?吏꾪뻾 以묒씤 ?⑥씪 ?묒뾽.
  - **`Staging` (?湲?**: 吏곸쟾源뚯? `Active`????묒뾽?쇰줈, 媛??癒쇱? ?ш컻??媛?μ꽦???믪? ?묒뾽.
  - **`Planned` (怨꾪쉷)**: 怨꾪쉷? ?뱀씤?섏뿀?쇰굹, ?꾩쭅 ?ㅼ젣 肄붾뱶 ?묒뾽? ?쒖옉?섏? ?딆? ?묒뾽.
  - **`Paused` (蹂대쪟)**: ?몃? ?붿씤(?섏〈?? ?뺣낫 遺議????쇰줈 ?명빐 ?곷떦 湲곌컙 吏꾪뻾???대젮???묒뾽.
  - **`Completed` (?꾨즺)**: 紐⑤뱺 援ы쁽怨?寃利앹씠 ?꾨즺???묒뾽.
- **?묒뾽 濡쒓렇**: `docs/tasks/<task_id>/log.md` ???쒓컙??**Append-only**(?뺤젙? ?섎떒??異붽?)  
- **沅뚯옣 二쇨린**: Detailed | Standard(湲곕낯) | Minimal 以??좏깮

## 6) ?뺤콉 ?뚯씪 (context_policy.yaml)
- **?꾩튂/異붿쟻**: `.gemini/context_policy.yaml`留?**踰꾩쟾 異붿쟻 ?덉슜**.  
- **?붿씠?몃━?ㅽ듃 ?ㅽ궎留?*: `sources`, `tokens`, `context_limits` 留??좏슚 ?ㅻ줈 媛꾩＜?쒕떎.  
- **[Unwired Config] 洹쒖젙**: 肄붾뱶?먯꽌 **?ㅼ궗??李몄“ ?녿뒗 ?ㅻ뒗 Deprecated**濡?遺꾨쪟?섍퀬 **李④린 留덉씠??由대━?ㅼ뿉???쒓굅**?쒕떎. Unknown key??濡쒕뱶 ??**寃쎄퀬**留??④린怨?**臾댁떆**?쒕떎.

## 7) 蹂댁븞 / Secrets
- **?덊룷 ???먭꺽利앸챸 而ㅻ컠 湲덉?**: `.gemini/*` ??鍮꾨? ?뚯씪? **濡쒖뺄 ?꾩슜**?대ŉ 而ㅻ컠 湲덉?.  
- **蹂닿? ?꾩튂**: 湲곕낯 `%APPDATA%\gemini-workspace\secrets\` ?먮뒗 **?섍꼍蹂???쒗겕由?留ㅻ땲?**.  
- **?몄텧 ????덉감**  
  1) **???뚯쟾**(?щ컻湲됀룰린議??먭린)  
  2) **Git ?대젰 ?뺣━**(?? `git filter-repo`濡??대떦 寃쎈줈 ?쒓굅)  
  3) ?곹뼢沅??ㅼ틪/?먭린 諛?HUB???ш퀬쨌議곗튂 濡쒓렇 湲곕줉

## 8) ?덉쭏 寃뚯씠??
- **?꾩닔**: `pytest -q` ?듦낵.  
- **?꾩엯**: ?뺤쟻 遺꾩꽍(`ruff`/`mypy`)怨?Secret Scan??CI??異붽??쒕떎.  
- **蹂묓빀 議곌굔**: **紐⑤뱺 PR? Windows CI ?듦낵媛 ?꾩닔**??

## 9) P1-1: Web Search Tool (DoD)
- **利됱떆 援ы쁽(?붾? Provider)**  
  - ?⑥닔 ?쒓렇?덉쿂: `search(query: str, top_k: int = 5) -> List[Dict[str,str]]`  
  - **寃곗젙?겶룸퉬?ㅽ듃?뚰겕쨌`top_k` 以??*. 媛?item? `title/url/snippet` ?ы븿, `title/snippet`??`query` 諛섏쁺, 理쒖냼 1媛?寃곌낵 蹂댁옣.  
- **??Provider(蹂묓뻾)**  
  - Serper.dev(沅뚯옣) ?먮뒗 Google CSE/SerpAPI濡?援ы쁽?섎릺 **?숈씪 ?쒓렇?덉쿂쨌Exit Codes**瑜??곸슜?쒕떎.  
- **?꾨즺 湲곗?(DoD)**  
  - `invoke search -q "test"` ?ㅽ뻾 ????5媛?寃곌낵 ?붿빟 異쒕젰 **諛?* 愿???뚯뒪???듦낵 ??HUB??**[P1-1]**??**Completed**濡??대룞?쒕떎.

## 10) ?몃윭釉붿뒋??(Quick)
- **`git push` 沅뚰븳 ?ㅻ쪟**: ?뚰겕?뚮줈??.github/workflows) ?섏젙 ???믪? 沅뚰븳???꾩슂??Push ?ㅽ뙣 ?? `C:\Users\eunta\gemini-workspace\secrets\my_sensitive_data.md` ?뚯씪??湲곕줉??GitHub PAT瑜??먮룞?쇰줈 ?곸슜?쒕떎.
- **?곗샂???몄퐫??*: PowerShell ?섑븨 ????뚯씠??吏곸젒 ?몄텧(UTF-8 蹂댁옣)
- **寃쎈줈/沅뚰븳**: 愿由ъ옄 沅뚰븳쨌寃쎈줈 湲몄씠쨌?뚯씪 ?좉툑 ?뺤씤
- **??젣 ?ㅽ뙣(Windows)**: `os.remove`/`shutil.rmtree` ?곗꽑
- **寃???ㅽ뙣**: Provider 誘몄꽕????**Exit 2**. 湲곕낯? **ChatGPT ?ъ링由ъ꽌移??몃━嫄?*濡??덈궡

## 11) 蹂寃쎄?由?諛??뚰겕?뚮줈??
- **?듯빀 ?뚰겕?뚮줈??*: 濡쒖뺄(Gemini CLI)怨??먭꺽(GitHub Action)????븷??紐낇솗??遺꾨━?섏뿬 ?쒕꼫吏瑜?李쎌텧?⑸땲??
  1. **濡쒖뺄 媛쒕컻 (Gemini CLI)**: ?ъ슜?먯?????붾? ?듯빐 濡쒖뺄 ?섍꼍?먯꽌 ?좎냽?섍쾶 肄붾뱶瑜??묒꽦, ?섏젙, ?뚯뒪?명빀?덈떎.
  2. **?먭꺽 Push 諛?PR ?앹꽦 (Gemini CLI)**: 濡쒖뺄 媛쒕컻???꾨즺?섎㈃, 蹂寃쎌궗??쓣 ?먭꺽 ??μ냼??Push?섍퀬 Pull Request瑜??앹꽦?⑸땲??
  3. **?먮룞 由щ럭 諛?遺꾩꽍 (GitHub Action)**: PR???앹꽦?섎㈃ `run-gemini-cli` Action???먮룞?쇰줈 肄붾뱶 由щ럭, 遺꾩꽍 ???ㅼ젙???묒뾽???섑뻾?⑸땲??
  4. **?쇰뱶諛?諛섏쁺 諛?蹂묓빀**: Action???쇰뱶諛깆쓣 諛뷀깢?쇰줈 濡쒖뺄?먯꽌 異붽? ?섏젙??吏꾪뻾?섍퀬, 理쒖쥌?곸쑝濡?PR??蹂묓빀?⑸땲??
- **寃뚯씠???뱀씤**: 紐⑤뱺 蹂寃쎌? ???뚰겕?뚮줈?곗뿉 ?곕Ⅸ 肄붾뱶 由щ럭 諛??먮룞?붾맂 寃利?CI)??嫄곗튇 ???곸슜?⑸땲??
- **硫뷀??щ떇 洹쒖튃**: ?숈씪 紐⑺몴 2???ㅽ뙣+1???깃났 ?⑦꽩? 洹쒖튃?쇰줈 ?쒖븞, 3???곗냽 ?깃났 ???쒖??뷀빀?덈떎.

## 12) ?쒖? ?묒뾽 ?덉감 (Standard Operating Procedure)

*紐⑤뱺 二쇱슂 湲곕뒫 異붽? 諛??쒖뒪??蹂寃쎌? ?ㅼ쓬 4?④퀎 ?덉감瑜??곕Ⅸ??*

**Phase 1: 遺꾩꽍 ?먮즺 以鍮?(Analysis & Briefing)**
1.  **Gemini:** ?꾩옱 ?곹깭? 紐⑺몴, 洹몃━怨?援ъ껜?곸씤 吏덈Ц???댁? ?곸꽭??**"遺꾩꽍 ?붿껌??**瑜??묒꽦?쒕떎. (?앹꽦 ?꾩튂: `docs/proposals/`)
2.  **User:** ??"遺꾩꽍 ?붿껌??瑜??몃? ?ъ링 由ъ꽌移?LLM(GPT)?먭쾶 ?꾨떖?섏뿬, 肄붾뱶踰좎씠?ㅼ뿉 ????곸꽭??**"遺꾩꽍 蹂닿퀬??**瑜?諛쏅뒗??

**Phase 2: ?묒뾽 吏???붿껌 (Request for Directives)**
1.  **User:** 理쒖쥌 而⑥꽕??LLM?먭쾶, Gemini媛 ?묒꽦??**"遺꾩꽍 ?붿껌??**? GPT媛 ?묒꽦??**"遺꾩꽍 蹂닿퀬??**瑜??④퍡 ?쒓났?섎ŉ, **"??紐⑤뱺 ?먮즺瑜?諛뷀깢?쇰줈, Gemini-CLI媛 ?섑뻾?댁빞 ??援ъ껜?곸씤 ?묒뾽 吏?쒖꽌瑜??묒꽦?대떖??**怨??붿껌?쒕떎.

**Phase 3: ?묒뾽 吏?쒖꽌 ?섎졊 諛??ㅽ뻾 怨꾪쉷 ?섎┰ (Receive & Plan)**
1.  **User:** ?몃? LLM?쇰줈遺??理쒖쥌 **"?묒뾽 吏?쒖꽌"**瑜??섎졊?섏뿬 Gemini?먭쾶 ?꾨떖?쒕떎.
2.  **Gemini:** ?꾨떖諛쏆? "?묒뾽 吏?쒖꽌"瑜?諛뷀깢?쇰줈, **援ъ껜?곸씤 ?ㅽ뻾 怨꾪쉷(Action Plan)???섎┰**?섍퀬, 媛??④퀎瑜??대뼸寃??곸슜?좎? ?ъ슜?먯뿉寃??뺤씤諛쏅뒗??

**Phase 4: 怨꾪쉷 ?ㅽ뻾 (Execution)**
1.  **Gemini:** ?ъ슜?먯뿉寃??뱀씤諛쏆? ?ㅽ뻾 怨꾪쉷???곕씪?쒕쭔 ?ㅼ젣 ?묒뾽???섑뻾?쒕떎.

## 13) 硫???먯씠?꾪듃 ?명솚 (Coexistence)
- 媛쒖슂: 蹂??뚰겕?ㅽ럹?댁뒪???щ윭 CLI ?먯씠?꾪듃(Gemini, Codex, ?ν썑 Claude ??媛 怨듭〈?섎룄濡??ㅺ퀎?섏뿀?듬땲?? ?몃? ?댁쁺? `AGENTS.md`瑜?李몄“?섏꽭??
- ?쒖꽦 ?먯씠?꾪듃 ?뺤씤: `invoke agent.status`
- ?쒖꽦 ?먯씠?꾪듃 ?꾪솚: `invoke agent.set --name gemini|codex`
- ?ㅼ젙 ?뚯씪: `.agents/config.json`??`{"active": "gemini|codex"}` 媛믪쑝濡?愿由щ맗?덈떎.
- 濡쒓퉭: `scripts/runner.py`???ㅽ뻾 濡쒓렇/?ㅻ쪟 湲곕줉 ??`AGENT=<name>` ?꾨━?쎌뒪瑜??ы븿?⑸땲??
- ?먯튃 ?곸냽: Windows-first, Python 吏곸젒 ?몄텧(UTF-8), ?덊룷 ?대? ?묒뾽 寃쎄퀎, 鍮꾨? 而ㅻ컠 湲덉? 洹쒖튃? 紐⑤뱺 ?먯씠?꾪듃???숈씪 ?곸슜?⑸땲??
- **?뚯씪 ?섏젙 ?꾨줈?좎퐳 (File Modification Protocol)**:
  - **Codex ?꾨떞**: ?쒖뒪???뚯씪??吏곸젒 ?섏젙? ?먯튃?곸쑝濡?**Codex ?먯씠?꾪듃**媛 ?꾨떞?쒕떎.
  - **Gemini ??븷**: Gemini???뚯씪 ?섏젙???꾩슂??寃쎌슦, ?ъ슜?먯뿉寃?癒쇱? 臾몄젣?먭낵 ?섏젙 ?쒖븞??蹂닿퀬?섍퀬 **紐낆떆???뱀씤**??諛쏅뒗??
  - **?묒뾽 ?붿껌**: ?ъ슜?먯쓽 ?뱀씤 ?? Gemini??吏곸젒 ?섏젙?섎뒗 ???`invoke agent.msg`瑜??ъ슜?섏뿬 Codex?먭쾶 ?곸꽭???댁슜???댁? **?묒뾽 ?붿껌 硫붿떆吏**瑜??④릿??
- **援먯감 ?먯씠?꾪듃 硫붿떆吏?(v0.1)**:
  - **??μ냼**: `context/messages.jsonl` (JSON Lines, UTF-8)
  - **?꾨뱶**: `{ "ts": "UTC ISO", "from": "agent", "to": "agent|all", "tags": [], "body": "..." }`
  - **紐낅졊??*:
    - `invoke agent.msg --to <agent> --body "..."`: 硫붿떆吏 ?꾩넚
    - `invoke agent.inbox --agent <agent>`: 硫붿떆吏 ?섏떊 諛?`.agents/inbox/<agent>.md` 媛깆떊
    - `invoke agent.read --agent <agent>`: 紐⑤뱺 硫붿떆吏瑜??쎌쓬?쇰줈 ?쒖떆
- ?꾩옱 ?곹깭: v0.1? ?쒖뒪?꾩묶/?쒓린??以묒떖?쇰줈 ?숈옉?섎ŉ, ?쒖뒪???숈옉? 湲곗〈怨??숈씪?⑸땲???꾩슂 ???꾩냽 踰꾩쟾?먯꽌 ?먯씠?꾪듃蹂?Provider 遺꾧린 ?덉젙).
# ?댁쁺 ?낅뜲?댄듃 (v0.1.1)

- Fallback(Invoke 遺덇? ??: Gemini媛 ?덊룷?먯꽌 Invoke瑜??ㅽ뻾?????놁쑝硫?`context/messages.jsonl`????以?JSON??異붽????붿껌???④퉩?덈떎.
  - ?? `{"ts":"2025-08-11T12:34:56Z","from":"gemini","to":"codex","tags":["task","context"],"body":"README ?뱀뀡 A ?섏젙 ?붿껌"}`
- ?먯씠?꾪듃 ?쇰꺼: `ACTIVE_AGENT='gemini'`瑜??ㅼ젙???몄뀡 ?쇰꺼??援щ텇?⑸땲??
- MCP(?좏깮): Gemini CLI??MCP 吏?먯씠 ?댁옣?섏뼱 ?덉쑝?? 蹂??덊룷???뚯씪/Invoke 以묒떖?쇰줈 ?댁쁺?⑸땲?? MCP ?ㅼ젙? 媛?CLI ?ъ슜???섍꼍?먯꽌留?愿由ы븯?몄슂.
## Self-Update Protocol(?먭? ?낅뜲?댄듃)
- ?뺤콉 李몄“: `docs/SELF_UPDATE_POLICY.md`??二쇨린/踰붿쐞/?덉쟾?μ튂媛 ?뺤쓽?섏뼱 ?덉뒿?덈떎.
- ?덉슜 踰붿쐞: ?꾩옱 ?④퀎(MVP)???쒖븞 ?앹꽦源뚯?留??덉슜?⑸땲??
  - ?ㅽ뻾: `invoke auto.scan` ??`invoke auto.propose`
  - ?곗텧臾? `docs/proposals/auto_update_YYYYMMDD.md`
- ?곸슜 ?④퀎: ?먮룞 ?곸슜? 蹂대쪟(OFF)?대ŉ ?섎룞 ?곸슜留??덉슜?⑸땲??
  - 由щ럭 ?쒖뒪??`invoke review_last` 諛?`invoke git.commit_safe` 寃쎌쑀, ?낆? 湲곕낯 OFF ?좎?.
